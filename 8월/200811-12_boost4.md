### 네이버_부스트코스_4

## 프래그먼트 이해하기

1. 프래그먼트 만들기

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-671954712">

- 추가한 내용들(레이아웃)이 다른 화면에도 필요할 경우, 태그도 복사해서 일일이 넣어야하고 소스 코드도 그대로 기능을 구현해줘야 한다. 왜냐하면 다른 액티비티이기 때문에! 

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-671954836">

- 프래그먼트는 액티비티를 본떠서 만들었다. 하나의 액티비티에서 다른 액티비티 띄우려고 하면 시스템 쪽에 요청. 시스템에는 액티비티 매니저라는 것이 있다. 그러므로 시스템이 알아먹을 수 있는 인텐트라는 걸로 만들어서 요청!

- 액티비티 안에 존재하는 프래그먼트 매니저한테 요청하는 식.

- 액티비티의 내부에는 속성이나 메소드의 수가 상당히 많기 때문에 무겁다. 그러므로 액티비티 안에 액티비티를 부분 화면으로 올리는 것은 권장하지 않습니다.

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-671954945">

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-671955108">

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-671955238">

- 액티비티로 만든 화면 안에 부분 화면을 만들고 싶은 경우에는 레이아웃 안에 레이아웃을 넣으면 됩니다.

- 프래그먼트는 액티비티를 본 떠 만든 것이라 액티비티가 동작하는 방식과 아주 유사

- 프래그먼트에도 액티비티처럼 수명주기(Life Cycle)가 있습니다.
즉, 상태에 따라 자동으로 호출되는 수명주기 메소드가 있습니다.

- 프래그먼트가 메모리에 초기화되거나 화면에 보이기 전 또는 후에 호출되는 메소드, 그리고 메모리에서 없어질 때 호출되는 메소드 등이 있는 거죠.

- 크게 다른 점은 onAttach와 onDetach 메소드가 있다는 점. 프래그먼트는 액티비티 위에 올라갔을 때 비로소 프래그먼트로서 동작할 수 있기 때문에 액티비티 위에 올라갈 때 onAttach, 액티비티에서 내려올 때 onDetach 메소드를 자동으로 호출해줌으로써 그 시점을 알 수 있도록 해 줍니다.

- (매우 중요) 프래그먼트도 부분화면이기 때문에 하나의 XML 레이아웃 파일과 하나의 소스 파일로 정의할 수 있습니다.
XML 레이아웃 파일을 만들고 그 파일을 소스 파일에 설정하려면 프래그먼트 안에 있는 onCreateView 메소드 안에서 레이아웃 인플레이터를 이용해 인플레이션을 진행합니다.

```Java
public class MainFragment extends Fragment {
   @Nullable
   @Override
   public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container,

   @Nullable Bundle savedInstanceState) {
      ViewGroup rootView = (ViewGroup) inflater.inflate(R.layout.fragment_main,

      container, false);
      return rootView;
   }
}
```

- onCreateView 메소드는 자동으로 호출되는 메소드이며 파라미터로 LayoutInflater 객체를 전달해줍니다.
따라서 이 객체의 inflate 메소드를 이용해 인플레이션을 진행할 수 있습니다.
프래그먼트를 만들었다면 액티비티의 XML 레이아웃에 추가할 수 있습니다.
태그는 <fragment>를 사용하며 프래그먼트 클래스를 지정할 때는 name 속성을 사용합니다.

- 만약 소스 코드에서 프래그먼트를 추가하고 싶다면 프래그먼트 매니저를 사용

- 프래그먼트는 프래그먼트 매니저가 관리하기 때문에 프래그먼트 매니저를 통해 화면에 추가하거나 다른 프래그먼트로 교체

- 프래그먼트 매니저는 getSupportFragmentManager 메소드를 호출하면 참조할 수 있고 XML 레이아웃에 추가된 프래그먼트는 findFragmentById 메소드를 호출하여 찾아낼 수 있습니다.

- 프래그먼트에서 액티비티의 메소드를 호출하거나 액티비티에서 프래그먼트의 메소드를 호출하면 프래그먼트와 액티비티 간에 필요한 데이터를 전달하거나 필요한 기능을 수행하도록 할 수 있습니다.

1. MainActivity.java
```Java
package com.example.fragment;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class MainActivity extends AppCompatActivity {
    MainFragment fragment1;
    MenuFragment fragment2;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        fragment1 = new MainFragment();
        fragment2 = new MenuFragment();

        //소스 코드에서 프래그먼트 추가하는 방법 (버튼 눌렀을 때)
        Button button = (Button) findViewById(R.id.button3);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                // 프래그먼트 매니저 이용
                getSupportFragmentManager().beginTransaction().replace(R.id.container, fragment1).commit();
            }
        });

        Button button2 = (Button) findViewById(R.id.button2);
        button2.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                // replace 메서드 사용할 경우 대체해준다!
                getSupportFragmentManager().beginTransaction().replace(R.id.container, fragment2).commit();
            }
        });
    }

    public void onFragmentChange(int index) {
        if (index == 0) {
            getSupportFragmentManager().beginTransaction().replace(R.id.container, fragment1).commit();
        } else if (index == 1) {
            getSupportFragmentManager().beginTransaction().replace(R.id.container, fragment2).commit();
        }
    }
}
```

1. MainFragment.java
```Java
package com.example.fragment;

import android.content.Context;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;

public class MainFragment extends Fragment {
    MainActivity activity;

    @Override
    public void onAttach(@NonNull Context context) {
        super.onAttach(context);

        activity = (MainActivity) getActivity();// 프래그먼트 매니저에 의해서 액티비티 위에서 동작해야 함
    }

    @Override
    public void onDetach() {
        super.onDetach();

        activity = null;
    }

    @Nullable
    @Override// 프래그먼트도 액티비티를 본떠서 만들었기 때문에 얘도 수명주기 메서드를 가질 수 있다.
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        ViewGroup rootView = (ViewGroup) inflater.inflate(R.layout.fragment_main, container, false);
        // R.layout.fragment_main이라고 하는 것을 인플레이션 해달라. container라는 파라미터가 전달되고 이쪽으로 붙여달라.

        Button button3 = (Button) rootView.findViewById(R.id.button3);
        button3.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                activity.onFragmentChange(1);
            }
        });

        return rootView;// 여기서 인플레이션한 rootView를 리턴해주면 이게 프래그먼트의 화면으로 보이게 됩니다.
        // 이렇게 프래그먼트 1개가 만들어지는 것이다.
    }

}

```

1. MenuFragment.java
```Java
package com.example.fragment;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;

public class MenuFragment extends Fragment {

    @Nullable
    @Override// 프래그먼트도 액티비티를 본떠서 만들었기 때문에 얘도 수명주기 메서드를 가질 수 있다.
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        ViewGroup rootView = (ViewGroup) inflater.inflate(R.layout.fragment_menu, container, false);
        // R.layout.fragment_main이라고 하는 것을 인플레이션 해달라. container라는 파라미터가 전달되고 이쪽으로 붙여달라.
        return rootView;// 여기서 인플레이션한 rootView를 리턴해주면 이게 프래그먼트의 화면으로 보이게 됩니다.
        // 이렇게 프래그먼트 1개가 만들어지는 것이다.
    }

}

```

## 프래그먼트 사용하기

1. 프래그먼트로 이미지뷰어 만들기

- 한 화면에 두 개의 프래그먼트가 들어가 있도록 만들려면 먼저 액티비티의 XML 레이아웃에 <fragment> 태그를 이용해 두 개의 프래그먼트를 넣어줍니다.

```Java
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:orientation="vertical"
  >

  <fragment
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:name="org.techtown.fragment.ListFragment"
    android:id="@+id/listFragment"
    />

  <fragment
    android:layout_width="match_parent"
    android:layout_height="0dp "
    android:layout_weight="1"
    android:name="org.techtown.fragment.ViewerFragment"
    android:id="@+id/viewerFragment"
    />

</LinearLayout>
```

- 아래쪽에 추가된 프래그먼트는 ViewerFragment 라는 클래스를 가리키고 있으며 이 프래그먼트도 새로 정의합니다. 그 안에는 이미지뷰가 들어가도록 합니다.

## 액션바

1. 액션바 구성하기

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-672706702">

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-672706746">

- 메뉴는 XML과 JAVA소스코드로 정의. /res/menu 폴더를 만들고 그 안에 XML 파일을 넣으면 그 파일은 메뉴 파일로 인식됩니다. 메뉴를 위한 XML 파일에는 <menu> 태그를 넣을 수 있으며 그 안에 <item> 태그가 들어갑니다.

```Java
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">

    <item android:id="@+id/menu_refresh"
        android:title="새로고침"
        android:icon="@drawable/menu_refresh"
        app:showAsAction="always" />

</menu>
```

- showAsAction 메뉴는 안드로이드 SDK에 포함된 속성이 아니라 외부 라이브러리(appcompat-v7)에 포함된 속성이라서 android: 접두어가 아닌 app: 접두어를 붙여줍니다.

- 이 속성의 값을 always로 하면 화면 상단의 타이틀 부분에 메뉴 아이콘이 항상 보이게 됩니다. 다른 속성 값으로는 never(절대로 액션바에 표시하지 않음), ifRoom(표시할 수 있는 공간이 존재하면 표시), withText(메뉴의 아이콘과 텍스트를 같이 표시)

- 이렇게 만든 메뉴 XML은 액티비티 화면의 onCreateOptionsMenu 메소드 안에서 인플레이션

```Java
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_main, menu);
    return true;
}
```

- 액션바는 소스 코드에서 접근할 수 있으며 getActionBar 메소드를 호출하면 참조할 수 있습니다. show 메소드를 호출하면 액션바가 보이고 hide 메소드를 호출하면 액션바가 보이지 않게 됩니다.

```Java
ActionBar abar = getActionBar();
abar.show();
abar.hide();
```

<img src="https://github.com/OneLine-IF/TestLab/issues/2#issuecomment-672706776">

1. MainActivity.java
```Java
package com.example.myoptionmenu;

import androidx.annotation.NonNull;
import androidx.appcompat.app.ActionBar;
import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.Toast;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //ActionBar abar = getSupportActionBar();// 액션바 숨기기
        //abar.hide();
    }
    // 메뉴 xml도 여기서 붙여주는 과정이 필요하다.
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.menu_main, menu);
        return true;
    }
    // 만들어진 메뉴 아이콘들을 눌렀을 때 동작하도록 만들려면~

    @Override
    public boolean onOptionsItemSelected(@NonNull MenuItem item) {
        int curId = item.getItemId();
        switch(curId) {
            case R.id.menu_refresh:
                Toast.makeText(this, "새로고침 메뉴 클릭됨.", Toast.LENGTH_SHORT).show();
                break;
            case R.id.menu_search:
                Toast.makeText(this, "검색 메뉴 클릭됨.", Toast.LENGTH_SHORT).show();
                break;
            case R.id.menu_settings:
                Toast.makeText(this, "설정 메뉴 클릭됨.", Toast.LENGTH_SHORT).show();
                break;
            default:
                break;
        }

            return super.onOptionsItemSelected(item);
    }
}
```

1. menu_main.xml
```Java
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">

    <item
        android:id="@+id/menu_refresh"
        android:title="새로고침"
        android:icon="@drawable/ic_12"
        app:showAsAction="always"/>

    <item
        android:id="@+id/menu_search"
        android:title="검색"
        android:icon="@drawable/ic_15"
        app:showAsAction="always|withText"
        app:actionLayout="@layout/search_layout"/>

    <item
        android:id="@+id/menu_settings"
        android:title="설정"
        android:icon="@drawable/ic_all"
        app:showAsAction="always"/>

</menu>
```

1. search_layout.xml
```Java
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="검색"
        android:textSize="16dp"
        android:textColor="#ffad8745"/>
    
    <EditText
        android:id="@+id/editText"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:layout_marginLeft="4dp"/>


</LinearLayout>
```

## 탭 사용하기

1. 탭 만들기