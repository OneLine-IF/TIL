## 수명주기 이해하기
### 액티비티 수명주기
- 수명주기, 생명주기, 라이프사이클이라고함
<img src="https://user-images.githubusercontent.com/32586985/89422431-4c061f00-d770-11ea-8b44-e632519a55a0.PNG">

- 액티비티가 여러 개 있으면서 위의처럼 각각 상태가 다를 수 있음
- 앱을 여러개 사용하고 있을 때 다른 앱의 상태를 그대로 유지하고 다시 콜백을 하는 행위를 위해서 수명주기가 굉장히 중요함
- 수명주기에 따른 상태 변화
<img src="https://user-images.githubusercontent.com/32586985/89422501-65a76680-d770-11ea-944f-1216409a10ee.PNG">
<img src="https://user-images.githubusercontent.com/32586985/89422526-6e983800-d770-11ea-88a7-97cda0accea7.PNG">

- 앱 실행시 onCreate() 호출되고, onStart()가 호출되고, 다시 실행시 onResume()이 실행됨
- 화면 닫기 버튼 누를시 onPause() 호출되고 onStop()이 호출되며 onDestroy()가 호출됨  
- 화면이 포커스를 잃을 때 onPause(), 뒤로 들어가면서 완전히 중지된 상태인 onStop(), 메모리에서 리소스가 다 없어지면 onDestroy() 호출됨
- 맨 위의 사이클대로 돌아가게 됨
- 만든걸 예시로 생각을 해보면 내가 만든 화면에서 메뉴 화면을 버튼을 눌러서 띄우면 메인 화면은 중지된 상태 onPause(), onStop()의 상태가 된 것임 그 다음에 다시 실행이 될 시 onResume()이라고 하는 수명주기 메소드가 사용된 것임
- 액티비트는 가만히 떠 있는 상태가 아니므로
- 예를들어 게임 앱을 사용하다가 중지된 상태로 가면 onPause() 상태가 되고 메소드가 호출됨, 그 다음에 다시 실행시 onResume()이 실행됨, 즉 그러면 게임에서 점수가 있어서 저장시 onPause()를 다시 복구할 때는 onResume()을 사용함
- onPause()와 onResume()이 상대적으로 더 중요함, 중지되는 시점에서 바로 호출되는게 onPause()이고 그 다음에 복구되기 바로 전이 onResume()임
- 일반적으로 onPause()상태에서 필요한 데이터를 저장함, 디스크에 남아있어야함, 파일이나 데이터베이스에 저장해야함 원래는
- 이것을 getSharedPreferences와 preference 매니저로 간단히 저장할 수 있음
- 이를 이용해서 화면에 입력 상자를 하나 만들어 값을 입력하고 버튼을 눌렀을 때 자동으로 저장됐다가 복구되는 걸 만들어 볼 수 있음
<img src="https://user-images.githubusercontent.com/32586985/89422641-925b7e00-d770-11ea-8ce0-f3b7fda13d81.PNG">
<img src="https://user-images.githubusercontent.com/32586985/89422651-95566e80-d770-11ea-92be-9666c6fad535.PNG">

- 라이프사이클에 상세 구분
<img src="https://user-images.githubusercontent.com/32586985/87839776-4d61cb80-c8d7-11ea-9dec-4cd2862f71a6.png">

- 생각해보기
- 메인 액티비티에서 메뉴 액티비티를 띄운다고 할 때 각각의 액티비티 별로 그 안에 정의한 수명주기 메소드가 호출될까요?
	- 토스트 메시지로 확인한 결과 액티비티를 띄울 경우 라이프 사이클의 일련의 과정에 해당하는 메소드가 호출이 과정에 맞춰서 됨
- onCreate() 외에 자주 호출되는 수명주기 메소드는 어떤 것일까요?
	- onResume(), onPause()가 상대적으로 자주 호출됨 

## 서비스 사용하기
### 서비스
- 서비스는 화면이 없는 걸 이야기함
- 자동으로 재시작되는 서비스
	- 서비스는 화면이 없는 상태에서 백그라운드로 실행됨
	- 서비스는 프로세스가 종료되어도 시스템에서 자동으로 재시작함
<img src="https://user-images.githubusercontent.com/32586985/89422873-d5b5ec80-d770-11ea-96bc-f4cf941882b6.PNG">

- 화면에 없더라도 뭔가 기능이 실행될 수 있게 만들어 준게 서비스임
- 하지만 서비스는 뒤에서 계속 실행되야 되는 그런 기능이 가장 기본적인 기능 중에 하나임, 서비스를 시스템이 자동으로 종료시켜도, 비정상 종료가 됐어도 시스템이 자동으로 재시작 시켜줌 계속 보고 있다가 그런 특징이 있음
- 그래서 수명주기 메소드 자체가 많지 않음, onCreate(), onDestroy() 정도
- 서비스는 startService로 시작함
- 새로운 서비스 추가
	- 프로젝트 영역에서 New → Service → Service 메뉴를 이용해 서비스 추가 (혹은 직접 서비스 클래스를 만들어도 됨)
- 액티비티에서 서비스 시작
	- 서비스 시작을 위해 startService 메소드를 호출
	- 메인 액티비티에서 버튼 누르면 시작하도록 할 수 있음
- 서비스 생성시 Mainfest에도 추가됨
- 서비스도 애플리케이션 구성요소여서 시스템이 관리를  함 그러므로 시스템에 요청하기 위해 인텐트를 사용해야하고 서비스 쪽으로 데이터 전달을 위해 엑스트라 데이터 부가데이터를 넣을 수 있음
- 서비스는 한번 실행되면 계속 실행되어 있으므로 StartService를 아무리 여러 번 실행해도 새로 만들어지지 않음, 인텐트 안에 넣어서 전달하는 것을 onCreate()에서 확인 할 수 없으므로, onStartCommand()로 확인함
- 아래와 같이 코드를 치고 서비스에 데이터가 전달된 것을 확인할 수 있음
<img src="https://user-images.githubusercontent.com/32586985/89423036-072eb800-d771-11ea-8351-81eaeef4a2b7.PNG">
<img src="https://user-images.githubusercontent.com/32586985/89423073-10b82000-d771-11ea-9421-bcec2c6ab29c.PNG">
<img src="https://user-images.githubusercontent.com/32586985/89423113-1877c480-d771-11ea-9cd2-40783a619ff7.PNG">

- Android Device Monitor에 들어가보면 위의 만든 패키지가 프로세스에 실행됨을 알 수 있는데 강제종료를 시켜도 자동으로 실행을 하게 됨 
- 서비스에서 액티비티로 반대로 보내주는 상황도 생김
- 하지만 여기서 서비스는 화면이 없는데서 화면 쪽으로 화면을 띄우면 문제가 생김, 화면은 태스크로 묶여 있는데 태스크는 내가 만든 화면 다른 사람이 만든 앱의 화면도 있음
- 그 앱의 각각의 화면끼리 필요하면 띄어줄 수 있도록 인텐트로 기본 브라우저 전화걸기 화면을 띄우는 것처럼 각각의 화면이 연속적으로 뜰 수 있도록 만들어 놓은 게 태스크임 
- 여기서 화면이 없는데서 화면을 띄우면 태스크라는 정보가 없어서 화면을 띄우는데 문제가 생기는데 이것을 띄우려면 옵션을 줘야하는데 플래그를 이용함
- 아래와 같이 코드를 써 5초뒤에 값을 받고 서비스에 있는 것을 액티비티로 넘겨주게끔 함, 로그는 위와 같이 뜸
<img src="https://user-images.githubusercontent.com/32586985/89423216-2e858500-d771-11ea-92ab-41e2135634ae.PNG">
<img src="https://user-images.githubusercontent.com/32586985/89423244-36ddc000-d771-11ea-83e8-803fcaa56c9c.PNG">
<img src="https://user-images.githubusercontent.com/32586985/89423270-3e9d6480-d771-11ea-97c3-7ce93867f6e9.PNG">

- 데이터를 주고 받을 때 서버와 주고 받는 경우가 있기 때문엥 서비스가 자주 사용됨, 서버 쪽하고 서비스를 주고 받기 때문에
- 생각해보기
- 어떤 경우에 액티비티가 아닌 서비스에서 기능을 실행하도로 해야 하는 걸까요?
	- 화면이 보이지 않더라도 기능을 해야하는 경우 알람 기능이라던가 서버와 통신을 해서 데이터를 받는등의 역할을 할 경우 서비스가 필요할 것 같음
- 인터넷을 통해 데이터를 주고받는 기능을 액티비티에 넣어두는 경우 어떤 문제가 발생할 수 있을까요?
	- 만일 서비스를 이용하지 않고 액티비티만을 사용했을 경우 비정상적으로 종료가 되었거나 불가피하게 액티비티를 사용하지 않을 경우 그에 해당하는 데이터가 소실되거나 제대로 전달받을 수 없는 경우가 생길 수 있기 때문에 이러한 경우 서비스를 사용했을 경우 종료되었어도 자동으로 다시 실행되게끔 할 수 있기 때문에 서비스가 오히려 이런 차원에서 더 유용하고 안전하다고 볼 수 있음