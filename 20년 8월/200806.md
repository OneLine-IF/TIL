## 브로드캐스트 수신자 사용하기
### 브로드캐스트 수신자
- 브로드캐스팅되는 메시지를 받는 게 브로드캐스트 수신자임
- 브로드캐스트 수신자
<img src="https://user-images.githubusercontent.com/32586985/89489622-e05e9900-d7e5-11ea-987b-284d5a89e0a2.PNG">

- 애플리케이션이 글로벌 이벤트(global event)를 받아서 처리하려면 브로드캐스트 수신자로 등록
- 글로벌 이벤트란 "전화가 왔습니다.", "문자 메시지가 도착했습니다"와 같이 안드로이드 시스템 전체에 보내지는 이벤트
- 브로드캐스트 수신자는 인텐트필터를 포함하며, 매니페스트 파일에 등록함으로써 인텐트를 받을 준비를 함
- 수신자가 매니페스트 파일에 등록되었다면 따로 시작시키지 않아도 됨
- 애플리케이션은 컨텍스트 클래스의 registerReceiver 메소드를 이용하면 런타임 시에도 수신자를 등록할 수 있음
- 서비스처럼 브로드캐스트 수신자도 UI가 없음
- 인텐트의 메시지를 넣어서 브로드캐스팅을함, 클라이언트와 서버가 있어서 데이터를 주고받고 채팅 데이터를 1대1로 주거받거나 여러 사람한테 한꺼번에 데이터가 뿌려지는 것을 브로드캐스팅이라고 함
- 이 브로드캐스팅 방식으로 인텐트가 뿌려짐, 뿌려지는 인텐트라는 객체르르 브로드캐스트 리시버를 등록하면 받을 수 있음 
- 인텐트를 해석하는 과정
<img src="https://user-images.githubusercontent.com/32586985/89489682-fec49480-d7e5-11ea-9743-046b111fc285.PNG">

- 브로드캐스트의 구분
- 인텐트와 브로드캐스트
	- 인텐트를 이용해서 액티비티를 실행하면 포그라운드(foreground)로 실행되어 사용자에게 보여지지만
	- 브로드캐스트를 이용해서 처리하면 백그라운드(background)로 동작하므로 사용자가 모름
	- 인텐트를 받으면 onReceive() 메소드가 자동으로 호출됨
- 브로드캐스트의 구분
	- 브로드캐스트는 크게 두 가지 클래스로 구분됨
	- 일반 브로드캐스트(sendBroadcase() 메소드로 호출)
		- 비동기적으로 실행되며 모든 수신자는 순서없이 실행됨(때로는 동시에 실행됨)
		- 효율적이나, 한 수신자의 처리 결과를 다른 수신자가 이용할 수 없고 중간에 취소불가
	- 순차 브로드캐스트(sendOrderedBroadcase() 메소드로 호출)
		- 한 번에 하나의 수신자에만 전달되므로 순서대로 실행됨, 중간에 취소하면 그 다음 수신자는 받지 못함, 수신자가 실행되는 순서는 인텐트필터의 속성으로 정할 수 있음, 순서가 같으면 임의로 실행됨
- 브로드캐스트 수신자 예제
<img src="https://user-images.githubusercontent.com/32586985/89489748-26b3f800-d7e6-11ea-87fd-4ef6b07050ab.PNG">

- app → New → Other → Broadcast Receiver를 만듬
- SmsReceiver라는 브로드캐스트 수신자를 만들어 넣고 어떤 걸 받겠다고 매니페스트 파일에 등록을 함
- 모든 인텐트를 받지 않고 SMS가 왔을 때 텔레포니 모듈에서 아래와 같은 액션 정보를 넣어 던지고 그것을 받겠다는 의미 SMS 문자가 들어가 있는 걸 받을 수 있음
- intent_filter도 인텐트 중에서 어떤거를 받겠다고 걸러주는 역할을 함
- intent_filter로 걸려서 받겠는데 인텐트안에 이런 액션정보가 들어가 있으면 받겠다는 의미
- 더불어서 SMS를 받는 기능을 퍼미션 해서 권한을 줘야함
<img src="https://user-images.githubusercontent.com/32586985/89489786-3d5a4f00-d7e6-11ea-9d4f-27cc9d9b4920.PNG">
<img src="https://user-images.githubusercontent.com/32586985/89489792-40edd600-d7e6-11ea-8045-7d18d8f0db37.PNG">

- 앱을 실행시키고 문자메시지를 가상 에뮬에 보내면 onReceive()를 확인할 수 있음
- 아래와 같이 코드를 쳐서 Log를 찍어볼 수 있음
<img src="https://user-images.githubusercontent.com/32586985/89489852-5b27b400-d7e6-11ea-9d17-404efe3dd94b.PNG">

- SMS 데이터를 화면에 보여주는 기능을 만들어볼 것임
- 아래와 같이 코드를 더 추가함
<img src="https://user-images.githubusercontent.com/32586985/89489885-6b3f9380-d7e6-11ea-927b-f956a242bc4d.PNG">

- 아래와 같이 액티비티 쪽에서 인텐트 안에 들어가 있는 부가 데이터를 받아서 처리해야함
<img src="https://user-images.githubusercontent.com/32586985/89489904-772b5580-d7e6-11ea-8adf-526b95a5d590.PNG">

- 앱을 SMS 처리하는 걸로 만들어서 좀 더 예쁘게 사용할 수 있음
- 생각해보기
- 여러분이 직접 브로드캐스팅 메시지를 보낼 수도 있을까요?
	- 브로드캐스팅 과정에서 추가를 한다면 보낼 수도 있다고 생각이 든다
- 브로드캐스트 수신자로 전달받은 메시지를 다시 인텐트에 넣어 액티비티로 보내는 복잡한 과정을 거치지 않고 브로드캐스트 수신자로 전달받은 메시지를 바로 화면에 보여줄 수도 있을까요?
	- 가능은 하겠지만 그렇게 만드는것이 오히려 더 번거로운 과정이 되고 에러가 발생할 수도 있다고 생각이든다 애초에 서비스도 그렇고 브로드캐스트 수신자도 화면이 없는 것이어서 그것을 처리하는 과정이 생겨서 그런 것인데 그 과정을 생략하고 메시지를 화면에 띄운다면 더 복잡하거나 에러가 생길 것 같다

### 위험권한 부여하기
- 일반 권한과 위험 권한(마시멜로 API23부터)
	- 위험 권한은 실행 시 권한 부여
<img src="https://user-images.githubusercontent.com/32586985/89489965-9d50f580-d7e6-11ea-91d1-e13f0b42105e.PNG">

- 대표적인 위험 권한들
<img src="https://user-images.githubusercontent.com/32586985/89489986-a8a42100-d7e6-11ea-8696-141eebcaa874.PNG">

- 실행 시 권한 부여
	- 실행 시 권한 부여를 묻는 대화상자 표시
<img src="https://user-images.githubusercontent.com/32586985/89490007-b8236a00-d7e6-11ea-979b-077973fcb95c.PNG">

- 위와 같은 기능을 만들 수 있음, 권한 부여 전 대화상자 보여주기
- 아래와 같이 코드를 쳐서 실행시킬 경우 대화상자가 나와 권한부여를 판단하고 그것에 맞춰서 권한을 부여했는지를 확인할 수 있음
- 앱 실행시 권한부여 대화상자가 나오고 승인 및 거부를 할 수 있음
<img src="https://user-images.githubusercontent.com/32586985/89490043-ca9da380-d7e6-11ea-98ba-36f2da82e7fb.PNG">

- 생각해보기
- 하나의 위험 권한에 대해서 매니페스트 파일(AndroidManifest.xml)에만 권한을 추가하고 코드에서는 위험 권한 부여 요청을 하지 않았을 경우 앱을 실행하면 어떤 현상이 벌어질까요?
	- 버전에 따라 다를 수 있지만 권한을 추가하고 코드로 추가저거으로 위험 권한을 부여할 수 있게끔 직접 코드에서 추가하는 과정도 필요함
- SD 카드에 파일을 쓰는 기능은 위험 권한으로 분류된 두 가지 권한을 요구합니다. 그러면 이 기능을 사용하기 위해 어떤 과정을 거쳐야 할까요?
	- 각각의 기능에 맞춰서 위험권한을 부여하게끔 하고 해당 SD 카드 파일을 쓰거나 그 해당하는 위험권한을 쓸 때 그것에 맞춰서 확인할 수 있게끔 위의 과정을 써서 위험권한을 확인하고 부여하면 될 것 같음
